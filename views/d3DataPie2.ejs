<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>D3: Pie layout ring chart</title>
      <script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
		<style type="text/css">

			text {
				font-family: sans-serif;
				font-size: 12px;
				fill: white;
			}

		  .arc path:hover {
		    fill:#333;
      }

		</style>
	</head>
	<body>

    <div class="row">
      <div class="col-md-6">
        <legend>Pie</legend>
        <div id="chart_div"></div>
      </div>
    </div>
    <%if(dataset.length<1){%>
		<div>無資料</div>
    <%}%>
    	<%dataset.forEach( function(item){%>
		<div><%=item.name%>,<%=item.count%></div>
    <%})%>

		<script type="text/javascript">

		  //Width and height
		  var w = 300;
		  var h = 300;

		  //var data = [5, 10, 20, 45, 6, 25];

		  var data =[];
		  <% dataset.forEach(function (item) { %>
        data.push({
          "name" : "<%=item.name%>",
          "value" :  <%= item.count %>
          })
      <%}) %>

		  var outerRadius = w / 2;
		  var innerRadius = w / 6;
		  var arc = d3.svg.arc()
							.innerRadius(innerRadius)
							.outerRadius(outerRadius);

		  var pie = d3.layout.pie()
        .sort(null)
        .value(function (d) {
		      return d.value;
		  });

		  //Easy colors accessible via a 10-step ordinal scale
		  var color = d3.scale.category20();

		  //Create SVG element
		  var svg = d3.select("#chart_div")
						.append("svg")
						.attr("width", w)
						.attr("height", h);

		  //Set up groups
		  var arcs = svg.selectAll("g.arc")
						  .data(pie(data))
						  .enter()
						  .append("g")
						  .attr("class", "arc")
						  .attr("transform", "translate(" + outerRadius + "," + outerRadius + ")");

		  //Draw arc paths
		  arcs.append("path")
          .attr("stroke", "white")
			    .attr("fill", function (d, i) {
			      return color(i);
			    })
			    .attr("d", arc);

		  //Labels
		  arcs.append("text")
			    .attr("transform", function (d) {
			      return "translate(" + arc.centroid(d) + ")";
			    })
			    .attr("text-anchor", "middle")
			    .text(function (d) {
			      return d.data.name+"-"+d.value;
			    });

		</script>
	</body>
</html>